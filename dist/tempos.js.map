{"version":3,"file":"tempos.js","sources":["../src/tool/oneobj.js","../src/tool/type.js","../src/config.js","../src/tool/cache.js","../src/tool/loader.js","../src/compile/compiler.js","../src/tool/log.js","../src/filter/escape.js","../src/filter/upper.js","../src/filter/trim.js","../src/filter/lower.js","../src/filter/defaults.js","../src/filter/join.js","../src/filter/size.js","../src/filter/replace.js","../src/filter/eq.js","../src/filter/truncate.js","../src/compile/index.js","../src/compile/render.js","../src/index.js"],"sourcesContent":["module.exports = function(source) {\r\n    const obj = {};\r\n    source.replace(/([$_\\w]+)/g, function(word) {\r\n        obj[word] = true;\r\n    });\r\n    return obj;\r\n};","const oneobj = require('./oneobj');\r\nconst DATA_TYPE_ARR = oneobj('Boolean Number String Function Array Object RegExp Set Map process');\r\n\r\nfor( let key in DATA_TYPE_ARR ) {\r\n    DATA_TYPE_ARR['[object ' + key + ']'] = key.toLowerCase();\r\n}\r\n\r\nmodule.exports = {\r\n    check: function(obj, type) {\r\n        var types = null == obj ? '' + obj : DATA_TYPE_ARR[ Object.prototype.toString.call(obj) ] || 'object';\r\n        return void 0 !== type ? type === types : types;\r\n    }\r\n};","const oneobj = require('./tool/oneobj');\r\nconst Type = require('./tool/type');\r\n\r\nconst config = {\r\n    debug: true,\r\n\r\n    cache: true,\r\n\r\n    startTag: '{{',\r\n\r\n    endTag: '}}',\r\n\r\n    extname: '.temp',\r\n\r\n    filepath: null,\r\n\r\n    isNode: (function() {\r\n        let flag = false;\r\n        try{\r\n            flag = global && Type.check(global.process, 'process');\r\n        } catch (e){//\r\n        }\r\n        return flag;\r\n    })(),\r\n\r\n    ignore: (function() {\r\n        const KEYS = '$__data__ $__filter__ $__out__ '+\r\n            'do if for let new try var case else with await break true false '+\r\n            'catch class const super throw while yield delete export import return switch default '+\r\n            'extends finally continue debugger function arguments instanceof typeof catch void this in try';\r\n\r\n        return oneobj(KEYS);\r\n    })()\r\n};\r\nmodule.exports = config;","const config = require('../config');\r\n\r\nclass Caches {\r\n    constructor() {\r\n        this._data = Object.create(null);\r\n    }\r\n    get(key) {\r\n        return config.cache ? this._data[key] : null;\r\n    }\r\n\r\n    set(key, val) {\r\n        if( config.cache ) {\r\n            this._data[key] = val;\r\n        }\r\n    }\r\n\r\n    detail(key, callback) {\r\n        let self = this, ret;\r\n        if( !(ret = self.get(key)) ) {\r\n            self.set(key, ret = callback());\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n\r\nmodule.exports = Caches;","const config = require('../config');\r\nconst Cache = require('./cache');\r\nconst fileCache = new Cache();\r\n\r\nconst loader = (source, obj) => {\r\n    let ret = '';\r\n    if( config.isNode ) {\r\n        const fs = require('fs');\r\n        const path = require('path');\r\n        source = path.resolve( path.dirname(config.filepath), source );\r\n        if( !path.extname( source) ) {\r\n            source += config.extname;\r\n        }\r\n        if( obj ) {\r\n            obj.fnName = path.basename(source, config.extname);\r\n        }\r\n        ret = fileCache.detail(source, () => {\r\n            return fs.readFileSync(source, 'utf8');\r\n        });\r\n    }\r\n    else {\r\n        const el = document.querySelector(source);\r\n        if( el ) {\r\n            ret = el.value || el.innerHTML;\r\n        }\r\n    }\r\n    return ret;\r\n};\r\nmodule.exports = loader;","const Cache = require('../tool/cache');\r\nconst config= require('../config');\r\nconst loader= require('../tool/loader');\r\n\r\nconst fnCache = new Cache();\r\nconst expCache = new Cache();\r\nconst tokenCache = new Cache();\r\nconst strCache = new Cache();\r\nconst rQACache = new Cache();\r\nconst filterCache = new Cache();\r\nconst fnBodyCache = new Cache();\r\n\r\nconst DATA = '$__data__';\r\nconst OUT = '$__out__';\r\nconst FILTER = '$__filter__';\r\nconst RDEF_EXP = /#def\\.([$_a-zA-Z](?:\\w+)?)/;\r\nconst RUSE_EXP = /#use\\.([$_a-zA-Z](?:\\w+)?)/;\r\nconst RINCLUDE_EXP = /(include\\s+)(?:\\'|\\\")([^\\'\\\"]+)(?:\\'|\\\")(?:\\s+)?([\\w\\W]+)?/; // eslint-disable-line\r\nconst REXTEND_EXP = /(extend\\s+)(?:\\'|\\\")([^\\'\\\"]+)(?:\\'|\\\")(?:\\s+)?([\\w\\W]+)?/; // eslint-disable-line\r\nconst RVCODE = /[\\w_$]/;\r\nconst RVAR_PREFIX = /^[a-zA-Z_$]/;\r\n\r\nconst createFnBody = (self) => {\r\n    return fnBodyCache.detail(self.template, () => {\r\n        let key;\r\n        let fnbody = '';\r\n        let subs = '';\r\n        let vars = `var ${OUT} = '',${FILTER}=this`;\r\n        \r\n        // Add variable\r\n        for( key in self.vars ) {\r\n            vars += `,${key}=${DATA}.${key}`;\r\n        }\r\n        vars += ';\\n';\r\n    \r\n        self.tokens.forEach(function(tok) {\r\n            const flag = tok.def || tok.use || tok.include;\r\n    \r\n            if( tok.def || tok.include || tok.extend ) {\r\n                subs += `var ${tok.fnName}=function(${DATA}) {\\n` + createFnBody(tok.compile) + '};\\n';\r\n            }\r\n            if( tok.use || tok.include || tok.extend ) {\r\n                fnbody += `${OUT} += ${tok.fnName}.call(${FILTER}, ${tok.params || DATA});\\n`;\r\n            }\r\n            else if( !flag && false === tok.out ) {\r\n                fnbody += `${tok.source}\\n`;\r\n            }\r\n            else if( !flag ) {\r\n                fnbody += `${OUT} += ` + (tok.out ? addFilters(tok) : `'${tok.source}'`) + ';\\n';\r\n            }\r\n        });\r\n        fnbody += `return ${OUT};\\n`;\r\n        return vars + subs + fnbody;\r\n    });\r\n};\r\n\r\nconst getTokenAndVars = (self) => {\r\n    const cnt = self.template;\r\n    return tokenCache.detail(cnt, () => {\r\n        let start = 0, end, ret = {\r\n            token: [],\r\n            vars: {}\r\n        };\r\n        while( -1 !== (end = cnt.indexOf(config.startTag, start)) ) {\r\n            if( end > start ) {\r\n                ret.token.push({\r\n                    source: replaceQuotesAndEnter( cnt.substring(start, end) )\r\n                });\r\n            }\r\n            start = parseExpression(self, ret.token, ret.vars, end + config.endTag.length);\r\n        }\r\n\r\n        if( start < self.template.length ) {\r\n            ret.token.push({\r\n                source: replaceQuotesAndEnter( cnt.substring(start) )\r\n            });\r\n        }\r\n\r\n        self.tokens = ret.token;\r\n        self.vars = ret.vars;\r\n        return ret;\r\n    });\r\n};\r\n\r\nconst replaceQuotesAndEnter = (str) => {\r\n    return rQACache.detail(str, () => {\r\n        let prev, c, s, res='', i=-1, len=str.length;\r\n        while( i++ < len ) {\r\n            prev = c;\r\n            c = str.charCodeAt(i);\r\n            s = str.charAt(i);\r\n            switch(c) {\r\n            case 0x27:\r\n            case 0x22:\r\n                res += (prev !== 0x5C ? '\\\\' : '') + s;\r\n                break;\r\n            case 0x0d:\r\n                res += '\\\\r';\r\n                break;\r\n            case 0x0a:\r\n                res += '\\\\n';\r\n                break;\r\n            default:\r\n                res += s;\r\n            }\r\n        }\r\n        return res;\r\n    });\r\n};\r\n\r\nconst parseExpression = (self, token, vars, start) => {\r\n    const cnt = self.template;\r\n    \r\n    const res = expCache.detail(cnt+start, () => {\r\n        let ret, exps, end, sdiff = 0, ediff = 0;\r\n\r\n        end = cnt.indexOf(config.endTag, start);\r\n        exps = cnt.substring(start, end).trim();\r\n        const tmp = {\r\n            out: false,\r\n            escape: false\r\n        };\r\n    \r\n        // {{#def ... #}}\r\n        if( (ret = exps.match(RDEF_EXP)) ) {\r\n            tmp.def = true;\r\n            tmp.fnName = ret[1];\r\n            sdiff = ret[0].length;\r\n            end = cnt.indexOf('#'+config.endTag, start);\r\n            ediff = 1;\r\n        }\r\n        // {{#use ... }}\r\n        else if( (ret = exps.match(RUSE_EXP)) ) {\r\n            tmp.use = true;\r\n            tmp.fnName = ret[1];\r\n            sdiff = ret[0].length;\r\n        }\r\n        // {{include ... }}\r\n        else if( (ret = exps.match(RINCLUDE_EXP)) ) {\r\n            tmp.include = true;\r\n            tmp.path = ret[2];\r\n            tmp.params = ret[3];\r\n            sdiff = ret[1].length;\r\n        }\r\n        // {{extend ... }}\r\n        else if( (ret = exps.match(REXTEND_EXP)) ) {\r\n            tmp.extend = true;\r\n            tmp.out = true;\r\n            tmp.path = ret[2];\r\n            tmp.params = ret[3];\r\n            sdiff = ret[1].length;\r\n        }\r\n        else {\r\n            switch( exps.charCodeAt(0) ) {\r\n            case 0x3d: // =\r\n                sdiff = 1;\r\n                tmp.escape = true;\r\n                tmp.out = true;\r\n                break;\r\n            case 0x2d: // -\r\n                sdiff = 1;\r\n                tmp.out = true;\r\n                break;\r\n            }\r\n        }\r\n        exps = cnt.substring(start+sdiff, end);\r\n        \r\n        if( tmp.def ) {\r\n            tmp.source = exps;\r\n            tmp.compile = new Compiler({\r\n                template: exps\r\n            });\r\n        }\r\n        else if( tmp.use ) {\r\n            tmp.params = exps;\r\n        }\r\n        else if( tmp.include || tmp.extend ) {\r\n            tmp.source = loader(tmp.path, tmp);\r\n            tmp.compile = new Compiler({\r\n                template: tmp.source\r\n            });\r\n        }\r\n        else {\r\n            ret = addvars(exps, vars);\r\n            tmp.source = ret.source;\r\n            tmp.filter = ret.filter;\r\n        }\r\n\r\n        // 添加变量\r\n        if( (tmp.use || tmp.include) && tmp.params ) {\r\n            addvars(tmp.params, vars);\r\n        }\r\n    \r\n        token.push(tmp);\r\n        return {\r\n            end: end,\r\n            ediff: ediff\r\n        };\r\n    });\r\n    return res.end + config.endTag.length + res.ediff;\r\n};\r\n\r\nconst parseStr =  (source) => {\r\n    const cnt = source.trim();\r\n    return strCache.detail(cnt, () => {    \r\n        const len = cnt.length;\r\n        let c, s, prev, curF;\r\n        let i = -1;\r\n        let vars = '';\r\n        let exps = '';\r\n        let fts = '';\r\n        let varObj = {};\r\n        let filter = {};\r\n        let inF = false;\r\n        let inS = false;\r\n        let newF = false;\r\n        \r\n        while( i++ < len ) {\r\n            prev = c;\r\n            c = cnt.charCodeAt(i);\r\n            s = cnt.charAt(i);\r\n            //\r\n            if( (c === 0x27 || c === 0x22) && prev !== 0x5C ) { //0x27:' 0x22:\" 0x5C:\\\r\n                inS = !inS;\r\n            }\r\n            else if(!inS && c === 0x7C && prev !== 0x7C && cnt.charCodeAt(i+1) !== 0x7C) { // |\r\n                newF = inF = true;\r\n            }\r\n            if( inF && (!inS && c===0x20 || i===len ) ) {\r\n                fts = fts.trim();\r\n                if( fts.charCodeAt(0) === 0x7C ) {\r\n                    newF = true;\r\n                }\r\n                else if( newF ) {\r\n                    filter[ curF = fts ] = [];\r\n                    newF = false;\r\n                }\r\n                else {\r\n                    filter[curF].push(fts);\r\n                }\r\n                fts = '';\r\n            }\r\n            else if( inF ) {\r\n                fts += s;\r\n            }\r\n            if( !RVCODE.test(s) ) {\r\n                vars = vars.trim();\r\n                RVAR_PREFIX.test(vars) && !filter[vars] ? varObj[vars] = true : null;\r\n                vars = '';\r\n            }\r\n            // Variable\r\n            else if( !inS ) { vars += s; }\r\n            // Expression\r\n            if( !inF ) { exps += s; }\r\n        }\r\n    \r\n        return {\r\n            source: exps.trim(),\r\n            vars: varObj,\r\n            filter: filter\r\n        };\r\n    });\r\n};\r\n\r\nconst addvars = (str, vars) => {\r\n    let ret = parseStr( str.trim() );\r\n    for( let key in ret.vars ) {\r\n        !config.ignore[key] ? vars[key] = true : null;\r\n    }\r\n    return ret;\r\n};\r\n\r\nconst addFilters = (tok) => {\r\n    return filterCache.detail(JSON.stringify(tok), ()=>{\r\n        let filters = tok.escape ? `${FILTER}.escape(` + tok.source + ')' : tok.source;\r\n        let flag;\r\n\r\n        for(let key in tok.filter) {\r\n            if( tok.escape && key === 'escape' ) continue;\r\n            \r\n            let params = ')';\r\n            if( tok.filter[key].length ) {\r\n                params = ',' + tok.filter[key].join(',')+')';\r\n            }\r\n            filters = `${FILTER}.${key}(${filters}` + params;\r\n            flag = 1;\r\n        }\r\n        return flag ? filters : '(' + filters + ')';\r\n    });\r\n};\r\n\r\nclass Compiler {\r\n    constructor(option) {\r\n        this.template = option.template;\r\n        this.tokens = null;\r\n        this.vars = {};\r\n        getTokenAndVars(this);\r\n    }\r\n\r\n    build() {\r\n        const self = this;\r\n        return fnCache.detail(self.template, ()=>{\r\n            return new Function(DATA, createFnBody(self));\r\n        });\r\n    }\r\n}\r\n\r\nmodule.exports = Compiler;","const config = require('../config');\r\nconst Type = require('../tool/type');\r\n\r\nconst print = (msg) => {\r\n    /* eslint-disable */\r\n    if( config.debug && console && console.log ) {\r\n        console.log(msg);\r\n    }\r\n    /* eslint-enable */\r\n};\r\n\r\nconst checkType = (name, data, type) => {\r\n    if( config.debug && !Type.check(data, type) ) {\r\n        throw new TypeError(name + ' Parameter type must be ' + type + '.');\r\n    }\r\n};\r\nmodule.exports = {\r\n    print: print,\r\n    checkType: checkType\r\n};","const Cache = require('../tool/cache');\r\nconst esCache = new Cache();\r\nconst rRep = /[<>\\\"\\'&]/g; // eslint-disable-line\r\n\r\nlet robj = {};\r\n['&','<','>','\"',\"'\"].forEach(function(it) { // eslint-disable-line\r\n    const code = it.charCodeAt(0);\r\n    robj[ code ] = '&#'+code+';';\r\n});\r\n\r\nconst escape = (data) => {\r\n    return esCache.detail(data, ()=>{\r\n        return rRep.test(data) ? data.replace(rRep, function(it) {\r\n            return robj[ it.charCodeAt(0) ] || it;\r\n        }) : data;\r\n    });\r\n};\r\n\r\nmodule.exports = escape;","const log = require('../tool/log');\r\n\r\nconst upper = (data, flag) => {\r\n    log.checkType('Filter:upper()', data, 'string');\r\n\r\n    let ret;\r\n    switch(flag) {\r\n    case true:\r\n        ret = data.replace(/\\b[a-z]\\w*\\b/g, function(word) {\r\n            return word.substr(0,1).toUpperCase() + word.substr(1);\r\n        });\r\n        break;\r\n    default:\r\n        ret = data.toUpperCase();\r\n    }\r\n    return ret || data;\r\n};\r\n\r\nmodule.exports = upper;","const log = require('../tool/log');\r\n\r\nconst trim = (data) => {\r\n    log.checkType('Filter:trim()', data, 'string');\r\n\r\n    return String.prototype.trim.call(data);\r\n};\r\n\r\nmodule.exports = trim;","const log = require('../tool/log');\r\n\r\nconst lower = (data) => {\r\n    log.checkType('Filter:lower()', data, 'string');\r\n\r\n    return data.toLowerCase();\r\n};\r\n\r\nmodule.exports = lower;","const defaults = (data, dstr = '') => {\r\n    return void 0 === data || null === data ? dstr : data;\r\n};\r\n\r\nmodule.exports = defaults;","const log = require('../tool/log');\r\n\r\nconst join = (data, connector = ',') => {\r\n    log.checkType('Filter:join()', data, 'array');\r\n\r\n    return data.join(connector);\r\n};\r\n\r\nmodule.exports = join;","const size = (data) => {\r\n    let size = data && data.length;\r\n    if( !size && typeof size === 'object' ) {\r\n        size = 0;\r\n        for( let key in data ) { // eslint-disable-line\r\n            size ++;\r\n        }\r\n    }\r\n    return size || 0;\r\n};\r\n\r\nmodule.exports = size;","const log = require('../tool/log');\r\n\r\nconst replace = (data, older, newer) => {\r\n    log.checkType('Filter:replace()', data, 'string');\r\n\r\n    return data.replace(older, newer);\r\n};\r\n\r\nmodule.exports = replace;","const Type = require('../tool/type');\r\n\r\nconst eq = (data, index = 0) => {\r\n    let ret;\r\n    let isObj = Type.check(data, 'object');\r\n    if( !(Type.check(data, 'array') || isObj || Type.check(data, 'string')) ) {\r\n        return ret;\r\n    }\r\n    if( 'last' === index ) {\r\n        if( isObj ) {\r\n            for( let key in data ) {\r\n                ret = data[key];\r\n            }\r\n        }\r\n        else {\r\n            ret = data[ data.length-1 ];\r\n        }\r\n    }\r\n    else {\r\n        ret = data[index];\r\n    }\r\n    return ret; \r\n};\r\n\r\nmodule.exports = eq;","const log = require('../tool/log');\r\n\r\nconst truncate = (data, length=255, end='...') => {\r\n    log.checkType('Filter:truncate()', data, 'string');\r\n\r\n    return data.length > length ? data.substr(0, length) + end : data;\r\n};\r\n\r\nmodule.exports = truncate;","const Compiler = require('./compiler');\r\nconst Cache = require('../tool/cache');\r\nconst config = require('../config');\r\nconst loader = require('../tool/loader');\r\nconst filter= require('../filter/index');\r\nconst Type = require('../tool/type');\r\n\r\nconst fnCache = new Cache();\r\n\r\nconst compile = (source, option = {}) => {\r\n    const types = Type.check(source);\r\n    if( 'object' === types ) {\r\n        option = source;\r\n    }\r\n    else if( 'string' === types ) {\r\n        config.filepath = source;\r\n        option.template = loader(source);\r\n    }\r\n    config.filepath = config.filepath || option.filepath;\r\n    option.template = option.template.trim();\r\n    return fnCache.detail(option.template, () => {\r\n        return new Compiler(option).build().bind(filter);\r\n    });\r\n};\r\n\r\nmodule.exports = compile;","const compile = require('./index');\r\n\r\nconst render = (content, data, option) => {\r\n    return compile(content, option)(data);\r\n};\r\nmodule.exports = render;","const config = require('./config');\r\nconst render = require('./compile/render');\r\nconst compile = require('./compile/index');\r\nconst filter = require('./filter/index');\r\nconst cache = require('./tool/cache');\r\n\r\nconst Tempos = (content, data, option) => {\r\n    return render(content, data, option);\r\n};\r\n\r\nTempos.render = render;\r\nTempos.compile = compile;\r\nTempos.Config = config;\r\nTempos.Filter = filter;\r\nTempos.Cache = cache;\r\n\r\nmodule.exports = Tempos;"],"names":["source","obj","replace","word","DATA_TYPE_ARR","oneobj","key","toLowerCase","type","types","Object","prototype","toString","call","flag","global","Type","check","process","e","_data","create","config","cache","this","val","callback","self","ret","get","set","fileCache","Cache","isNode","fs","require$$0","path","require$$1","resolve","dirname","filepath","extname","fnName","basename","detail","readFileSync","el","document","querySelector","value","innerHTML","fnCache","expCache","tokenCache","strCache","rQACache","filterCache","fnBodyCache","DATA","OUT","FILTER","RDEF_EXP","RUSE_EXP","RINCLUDE_EXP","REXTEND_EXP","RVCODE","RVAR_PREFIX","createFnBody","template","fnbody","subs","vars","tokens","forEach","tok","def","use","include","extend","compile","params","out","addFilters","getTokenAndVars","cnt","start","end","indexOf","startTag","token","push","replaceQuotesAndEnter","substring","parseExpression","endTag","length","str","prev","c","s","res","i","len","charCodeAt","charAt","exps","sdiff","ediff","tmp","trim","match","escape","Compiler","loader","addvars","filter","parseStr","curF","fts","varObj","inF","inS","newF","test","ignore","JSON","stringify","filters","join","option","Function","msg","debug","console","log","name","data","TypeError","esCache","rRep","robj","it","code","checkType","substr","toUpperCase","String","dstr","connector","size","older","newer","index","isObj","build","bind","content","Tempos","render","Config","Filter"],"mappings":"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"}